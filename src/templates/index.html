{% extends 'base.html' %}
{% block title %}Home{% endblock %}
{%block scripts %}
<script src="/static/js/edit.js"></script>
<script src="/static/js/pin.js"></script>
{% endblock %}
{% block body %}
<div id="info">
    {% if uploads==[] %}
    <div class="term">
        <h2>Nothing here yet...</h2>
    </div>
    {% endif %}
    <div class="processing-status">
        <h1>Processing...</h1>
    </div>
</div>

<div id="all-items">

{% for item in uploads %}

    {% if loop.first %}

    <!-- FEATURED POST -->

    <div class="term featured"
         onclick="location.href='/post/{{ item.name }}'"
         style="cursor:pointer"
         id="{{ item.display_datetime[1] }}">

        <div class="meta">
            <span class="user">{{ user }}</span> |
            {{ item.display_datetime[0] }}
        </div>

        <div class="media">
            <img src="{{ url_for('proxy_image', image_path=item.path) }}">
        </div>

        <pre class="description">
{{ item.description|striptags|truncate(300, True, '...') }}
        </pre>

    </div>

    <div class="thumb-row">

    {% else %}

    <!-- THUMB POSTS -->

    <div class="thumb-post"
         onclick="location.href='/post/{{ item.name }}'">

        <img src="{{ url_for('proxy_image', image_path=item.path) }}">

        <div class="thumb-overlay">
            {{ item.description|striptags|truncate(100, True, '...') }}
        </div>

    </div>

    {% endif %}

{% endfor %}

</div>

<!-- Edit Description + Date Modal -->
<div id="editModal" style="display:none; position:fixed; top:0; left:0; width:100%; height:100%; 
    background:#000000a1; justify-content:center; align-items:center; z-index:9999;">
    <div style="background:#1a1a1acb; padding:20px; border-radius:3px; width:350px; position:relative;border: 1px dashed #6d6d6d;">
        <h3>Edit Image</h3>
        <form id="editForm">
            <label for="editDescription">Description:</label>
            <textarea name="description" id="editTextarea" rows="6" style="width:100%;"></textarea>
            <label for="editDatetime">Date & Time:</label>
            <input type="datetime-local" name="display_datetime" id="editDatetime" style="width:100%;">
            <input type="hidden" name="filename" id="editFilename">
            <div style="margin-top:10px; text-align:right;">
                <button type="submit">Save</button>
                <button type="button" id="editCancel">Cancel</button>
            </div>
        </form>
    </div>
</div>


{% endblock %}
